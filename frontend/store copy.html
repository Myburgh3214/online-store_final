<!DOCTYPE html>
<head>
  <html>
  <title>Online Store</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link rel="stylesheet" href="https://www.w3schools.com/lib/w3-theme-black.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="css/stylesheet.css">
  <script src="scripts/requestHandler.js"></script>
  <script src="scripts/phpSession.js"></script>
</head>

<body id="myPage">
  <!-- Navbar -->
  <div class="w3-top">
    <div class="w3-bar w3-theme-d2 w3-left-align">

      <a class="w3-bar-item w3-button w3-hide-medium w3-hide-large w3-right w3-hover-white w3-theme-d2" href="index.html"><i
        class="fa fa-bars"></i></a>
      <a href="index.html" class="w3-bar-item w3-button w3-teal"><i class="fa fa-home w3-margin-right"></i>Home</a>
      <a href="store.html" class="w3-bar-item w3-button w3-hide-small w3-hover-white">Store Page</a>
      <a href="about.html" class="w3-bar-item w3-button w3-hide-small w3-hover-white">About</a>
      <a href="contact.html" class="w3-bar-item w3-button w3-hide-small w3-hover-white">Contact</a>
      <a href="galleryPage.html" class="w3-bar-item w3-button w3-hide-small w3-hover-white">Gallery</a>
      <div id="loggedInState">
        <a href="logIn.html" class="w3-bar-item w3-button w3-hide-small w3-hover-white">Login</a>
        <a href="signUp.html" class="w3-bar-item w3-button w3-hide-small w3-hover-white">Sign Up</a>
      </div>
      <div id="cart"></div>
    </div>
  </div>

  <!-- Team Container -->
  <div class="w3-container w3-padding-64 w3-center" id="team">
    <img src="images/koekieblom.jpg">
  </div>


  <div class="basket">
    <h2>Shop With Ease</h2>
    <div id="shop">
      <div class="greyBeanies" id="products-list">
      </div>
    </div>

    <div id='cart-wrapper' class="slider close">
      <div id='cart'>
        <div id="cart-products-wrapper">
          <table id="cart-table">
            <thead id="cart-table-header">
              <th class="name-col">Product Name</th>
              <th class="quantity-col">Quantity</th>
              <th class="price-col">Price</th>
            </thead>
            <tbody id="cart-table-body"></tbody>
          </table>
        </div>
      </div>

      <div id='amount-controls'>
        <div id="cart-amount-wrapper">
          <table>
            <tbody>
              <tr id='total-wrapper'>
                <td id="total-label">Total:</td>
                <td id="total">0.00</td>
              </tr>

              <tr id="promo-checkout">
                <td>
                  <button id="checkout">Place Order</button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  <!-- Container -->
  <div class="w3-container" style="position:relative">
    <a href="cart.html" class="w3-button w3-xlarge w3-circle w3-teal"
      style="position:absolute;top:-28px;right:24px">+</a>
  </div>

  <!-- Footer -->
  <footer class="w3-container w3-padding-32 w3-theme-d1 w3-center">
    <h4>Follow Us</h4>
    <a class="w3-button w3-large w3-teal" href="javascript:void(0)" title="Facebook"><i class="fa fa-facebook"></i></a>
    <a class="w3-button w3-large w3-teal" href="javascript:void(0)" title="Twitter"><i class="fa fa-twitter"></i></a>
    <a class="w3-button w3-large w3-teal" href="javascript:void(0)" title="Google +"><i
        class="fa fa-google-plus"></i></a>
    <a class="w3-button w3-large w3-teal" href="javascript:void(0)" title="Google +"><i class="fa fa-instagram"></i></a>
    <a class="w3-button w3-large w3-teal w3-hide-small" href="javascript:void(0)" title="Linkedin"><i
        class="fa fa-linkedin"></i></a>
    <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" target="_blank">w3.css</a></p>

    <div style="position:relative;bottom:100px;z-index:1;" class="w3-tooltip w3-right">
      <span class="w3-text w3-padding w3-teal w3-hide-small">Go To Top</span>
      <a class="w3-button w3-theme" href="#myPage"><span class="w3-xlarge">
          <i class="fa fa-chevron-circle-up"></i></span></a>
    </div>
  </footer>
  <script src="scripts/storeAndCart.js"></script>
  <script>
    window.productsReady = (products) => {
      let singleProduct = false;
      if (window.location.hash !== '' && window.location.hash !== '#') {
        singleProduct = window.location.hash.substring(1);
      }
      let newHtml = '';
      for (let product of products) {
        if (singleProduct !== false) {
          if (singleProduct !== product.id) continue;
          singleProduct = product;
        }

        newHtml += `<div>
            <p class="product-name" >${product.name}</p>
            <p class="product-description">${product.description}</p>
            <p class="product-price" >R${product.price}</p>`;
        if (singleProduct === false)
          newHtml +=`<button onclick="window.goToProduct('${product.id}')" class="add-to-cart">VIEW ITEM</button>`
        newHtml += `<button onclick="addProductToCart('${product.id}', '${product.name}')" class="add-to-cart">ADD TO CART</button>
          </div>`;
      }
      document.getElementById('products-list').innerHTML = newHtml;
      if (singleProduct !== false) {
        document.getElementsByTagName('title')[0].innerText = `${singleProduct.name} - Online Store`;
      }
    };
    function addProductToCart(productId, name) {
      window.cart.addItemToCart(productId);
      alert('Added 1x '+name+' to your cart');
      /*postRequest('orders', {
          backpack: document.getElementById('add-to-cart').value,
        },
        result => {
          if (result.status === 202) {
           document.getElementById('add-to-cart').value = "";
            alert('product added!');
            return;
          }
          result.text().then(x => alert(x));
        });*/
    }
  </script>
</body>

</html>